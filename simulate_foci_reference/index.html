
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../simulate_cell_reference/">
      
      
        <link rel="next" href="../license/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Simulate Foci - SMS_BP_Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simulate_foci_reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SMS_BP_Docs" class="md-header__button md-logo" aria-label="SMS_BP_Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SMS_BP_Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Simulate Foci
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/joemans3/SMS_BP" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SMS_BP_Docs" class="md-nav__button md-logo" aria-label="SMS_BP_Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SMS_BP_Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/joemans3/SMS_BP" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hello and Install
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../User_Guide_MD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Starter Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sim_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sim_config Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    cells
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            cells
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cells/budding_yeast_cell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Budding Yeast Cell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cells/cell_factory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cell Factory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/decorators_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/maskMaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mask Maker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../condensate_movement_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Condensate Movement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config_schema_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../errors_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json_validator_converter_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JSON Validator Converter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../probability_functions_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Probability Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run_cell_simulation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Run Cell Simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulate_cell_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulate Cell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Simulate Foci
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Simulate Foci
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulate_foci_reference" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate Foci Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulate Foci Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci" class="md-nav__link">
    <span class="md-ellipsis">
      simulate_foci
    </span>
  </a>
  
    <nav class="md-nav" aria-label="simulate_foci">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci--simulate_focipy" class="md-nav__link">
    <span class="md-ellipsis">
      simulate_foci.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="simulate_foci.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci--classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci--functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator" class="md-nav__link">
    <span class="md-ellipsis">
      Track_generator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Track_generator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant" class="md-nav__link">
    <span class="md-ellipsis">
      track_generation_constant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="track_generation_constant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_no_transition" class="md-nav__link">
    <span class="md-ellipsis">
      track_generation_no_transition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="track_generation_no_transition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_no_transition--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition" class="md-nav__link">
    <span class="md-ellipsis">
      track_generation_with_transition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="track_generation_with_transition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.axial_intensity_factor" class="md-nav__link">
    <span class="md-ellipsis">
      axial_intensity_factor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="axial_intensity_factor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.axial_intensity_factor--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.axial_intensity_factor--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_map_from_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_map_from_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_map_from_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_map_from_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_map_from_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points_from_cls" class="md-nav__link">
    <span class="md-ellipsis">
      generate_points_from_cls
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_points_from_cls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points_from_cls--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points_from_cls--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_radial_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_radial_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_radial_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_radial_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_radial_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_sphere_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_sphere_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_sphere_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_sphere_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_sphere_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      get_gaussian
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_gaussian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_gaussian--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_gaussian--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths" class="md-nav__link">
    <span class="md-ellipsis">
      get_lengths
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_lengths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap" class="md-nav__link">
    <span class="md-ellipsis">
      radius_spherical_cap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="radius_spherical_cap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.tophat_function_2d" class="md-nav__link">
    <span class="md-ellipsis">
      tophat_function_2d
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tophat_function_2d">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.tophat_function_2d--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.tophat_function_2d--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulate_foci_reference" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate Foci Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulate Foci Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci" class="md-nav__link">
    <span class="md-ellipsis">
      simulate_foci
    </span>
  </a>
  
    <nav class="md-nav" aria-label="simulate_foci">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci--simulate_focipy" class="md-nav__link">
    <span class="md-ellipsis">
      simulate_foci.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="simulate_foci.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci--classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci--functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator" class="md-nav__link">
    <span class="md-ellipsis">
      Track_generator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Track_generator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant" class="md-nav__link">
    <span class="md-ellipsis">
      track_generation_constant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="track_generation_constant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_no_transition" class="md-nav__link">
    <span class="md-ellipsis">
      track_generation_no_transition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="track_generation_no_transition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_no_transition--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition" class="md-nav__link">
    <span class="md-ellipsis">
      track_generation_with_transition
    </span>
  </a>
  
    <nav class="md-nav" aria-label="track_generation_with_transition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.axial_intensity_factor" class="md-nav__link">
    <span class="md-ellipsis">
      axial_intensity_factor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="axial_intensity_factor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.axial_intensity_factor--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.axial_intensity_factor--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_map_from_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_map_from_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_map_from_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_map_from_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_map_from_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points_from_cls" class="md-nav__link">
    <span class="md-ellipsis">
      generate_points_from_cls
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_points_from_cls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points_from_cls--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_points_from_cls--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_radial_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_radial_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_radial_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_radial_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_radial_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_sphere_points" class="md-nav__link">
    <span class="md-ellipsis">
      generate_sphere_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_sphere_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_sphere_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.generate_sphere_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      get_gaussian
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_gaussian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_gaussian--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_gaussian--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths" class="md-nav__link">
    <span class="md-ellipsis">
      get_lengths
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_lengths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.get_lengths--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap" class="md-nav__link">
    <span class="md-ellipsis">
      radius_spherical_cap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="radius_spherical_cap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.radius_spherical_cap--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.tophat_function_2d" class="md-nav__link">
    <span class="md-ellipsis">
      tophat_function_2d
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tophat_function_2d">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.tophat_function_2d--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SMS_BP.simulate_foci.tophat_function_2d--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Simulate Foci</h1>

<h2 id="simulate_foci_reference">Simulate Foci Reference<a class="headerlink" href="#simulate_foci_reference" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-module">



<a id="SMS_BP.simulate_foci"></a>
    <div class="doc doc-contents first">

        <h3 id="SMS_BP.simulate_foci--simulate_focipy">simulate_foci.py<a class="headerlink" href="#SMS_BP.simulate_foci--simulate_focipy" title="Permanent link">#</a></h3>
<p>This file contains the necessary classes and functions to simulate foci dynamics in space, particularly within cell simulations.</p>
<p>Author: Baljyot Singh Parmar</p>
<h4 id="SMS_BP.simulate_foci--classes">Classes:<a class="headerlink" href="#SMS_BP.simulate_foci--classes" title="Permanent link">#</a></h4>
<ul>
<li>Track_generator: A class to generate tracks of foci movements in a cell space with or without transitions.</li>
</ul>
<h4 id="SMS_BP.simulate_foci--functions">Functions:<a class="headerlink" href="#SMS_BP.simulate_foci--functions" title="Permanent link">#</a></h4>
<ul>
<li>get_lengths: Generates an array of track lengths based on a chosen distribution.</li>
<li>create_condensate_dict: Creates a dictionary of condensates for simulation.</li>
<li>tophat_function_2d: Defines a circular top-hat probability distribution in 2D.</li>
<li>generate_points: Generates random points following a given probability distribution.</li>
<li>generate_points_from_cls: Generates 3D points using the accept/reject method based on a given distribution.</li>
<li>generate_radial_points: Generates uniformly distributed points in a circle.</li>
<li>generate_sphere_points: Generates uniformly distributed points in a sphere.</li>
<li>radius_spherical_cap: Computes the radius of a spherical cap given the sphere's radius and a z-slice.</li>
<li>get_gaussian: Returns a 2D Gaussian distribution over a given domain.</li>
<li>axial_intensity_factor: Computes the axial intensity factor based on axial position.</li>
<li>generate_map_from_points: Generates a spatial map from given points and intensities.</li>
</ul>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="SMS_BP.simulate_foci.Track_generator" class="doc doc-heading">
            <code>Track_generator</code>


<a href="#SMS_BP.simulate_foci.Track_generator" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>A class to generate tracks of foci movements in a simulated cell space.</p>
<h5 id="SMS_BP.simulate_foci.Track_generator--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.Track_generator--parameters" title="Permanent link">#</a></h5>
<p>cell : BaseCell
    Cell object defining the space for track generation
oversample_motion_time : int | float
    Time for oversampling motion in milliseconds.</p>







              <details class="quote">
                <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Track_generator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to generate tracks of foci movements in a simulated cell space.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    cell : BaseCell</span>
<span class="sd">        Cell object defining the space for track generation</span>
<span class="sd">    oversample_motion_time : int | float</span>
<span class="sd">        Time for oversampling motion in milliseconds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cell</span><span class="p">:</span> <span class="n">BaseCell</span><span class="p">,</span>
        <span class="n">total_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">oversample_motion_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">cell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_allowable_cell_types</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span> <span class="o">=</span> <span class="n">oversample_motion_time</span>  <span class="c1"># in ms</span>
        <span class="c1"># total time in ms is the exposure time + interval time * (cycle_count) / oversample_motion_time</span>
        <span class="c1"># in ms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_time</span> <span class="o">=</span> <span class="n">total_time</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_allowable_cell_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># only allow rectangular cells for now</span>
        <span class="c1"># if not isinstance(self.cell, RectangularCell):</span>
        <span class="c1">#     raise ValueError(</span>
        <span class="c1">#         &quot;Only rectangular cells are supported for track generation&quot;</span>
        <span class="c1">#     )</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">track_generation_no_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">diffusion_coefficient</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>  <span class="c1"># um^2/s</span>
        <span class="n">hurst_exponent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">track_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">initials</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates the track generation with no transition between the diffusion coefficients and the hurst exponents</span>
<span class="sd">        namely, this means each track has a unique diffusion coefficient and hurst exponent</span>
<span class="sd">        This simulation is confined to the cell space and the axial range of the cell</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        diffusion_coefficient : float</span>
<span class="sd">            diffusion coefficient for the track</span>
<span class="sd">        hurst_exponent : float</span>
<span class="sd">            hurst exponent for the track</span>
<span class="sd">        track_length : int</span>
<span class="sd">            track_length for the track</span>
<span class="sd">        initials : array-like</span>
<span class="sd">            [[x,y,z]] coordinates of the initial positions of the track</span>
<span class="sd">        start_time : int</span>
<span class="sd">            time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        dict-like with format: {&quot;xy&quot;:xyz,&quot;times&quot;:times,&quot;diffusion_coefficient&quot;:diffusion_coefficient,&quot;hurst&quot;:hurst_exponent,&quot;initial&quot;:initial}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># initialize the fbm class</span>
        <span class="c1"># make self.space_lim relative to the initial position, using self.space_lim define the 0 to be initial position</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">initials</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="c1"># change the shape to (3,)</span>
            <span class="n">initials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">initials</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initials</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
        <span class="c1"># convert the diffusion_coefficients</span>
        <span class="c1"># diffusion_coefficient = self._convert_diffcoef_um2s_um2xms(</span>
        <span class="c1">#     diffusion_coefficient</span>
        <span class="c1"># )</span>
        <span class="n">fbm</span> <span class="o">=</span> <span class="n">FBM_BP</span><span class="p">(</span>
            <span class="n">n</span><span class="o">=</span><span class="n">track_length</span><span class="p">,</span>
            <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
            <span class="n">hurst_parameters</span><span class="o">=</span><span class="p">[</span><span class="n">hurst_exponent</span><span class="p">],</span>
            <span class="n">diffusion_parameters</span><span class="o">=</span><span class="p">[</span><span class="n">diffusion_coefficient</span><span class="p">],</span>
            <span class="n">diffusion_parameter_transition_matrix</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">hurst_parameter_transition_matrix</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">state_probability_diffusion</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">state_probability_hurst</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>
            <span class="n">initial_position</span><span class="o">=</span><span class="n">initials</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">fbm</span><span class="o">.</span><span class="n">fbm</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># make the times starting from the starting time</span>
        <span class="n">track_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="n">start_time</span><span class="p">,</span>
            <span class="p">(</span><span class="n">track_length</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">),</span>
            <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">track_xyz</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="c1"># create the dict</span>
        <span class="n">track_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="n">track_xyz</span><span class="p">,</span>
            <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">track_times</span><span class="p">,</span>
            <span class="s2">&quot;diffusion_coefficient&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_diff_a_n</span><span class="p">,</span>
            <span class="s2">&quot;hurst&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_hurst_n</span><span class="p">,</span>
            <span class="s2">&quot;initial&quot;</span><span class="p">:</span> <span class="n">initials</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># construct the dict</span>
        <span class="k">return</span> <span class="n">track_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">track_generation_with_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">diffusion_transition_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">hurst_transition_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">diffusion_parameters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>  <span class="c1"># um^2/s</span>
        <span class="n">hurst_parameters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">diffusion_state_probability</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">hurst_state_probability</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">track_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">initials</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Genereates the track data with transition between the diffusion coefficients and the hurst exponents</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        diffusion_transition_matrix : array-like</span>
<span class="sd">            transition matrix for the diffusion coefficients</span>
<span class="sd">        hurst_transition_matrix : array-like</span>
<span class="sd">            transition matrix for the hurst exponents</span>
<span class="sd">        diffusion_parameters : array-like</span>
<span class="sd">            diffusion coefficients for the tracks</span>
<span class="sd">        hurst_parameters : array-like</span>
<span class="sd">            hurst exponents for the tracks</span>
<span class="sd">        diffusion_state_probability : array-like</span>
<span class="sd">            probabilities for the diffusion coefficients</span>
<span class="sd">        hurst_state_probability : array-like</span>
<span class="sd">            probabilities for the hurst exponents</span>
<span class="sd">        track_length : int</span>
<span class="sd">            track_length for the track</span>
<span class="sd">        initials : array-like</span>
<span class="sd">            [[x,y,z]] coordinates of the initial positions of the track</span>
<span class="sd">        start_time : int</span>
<span class="sd">            time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        dict-like with format: {&quot;xy&quot;:xyz,&quot;times&quot;:times,&quot;diffusion_coefficient&quot;:diffusion_coefficient,&quot;hurst&quot;:hurst_exponent,&quot;initial&quot;:initial}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># make self.space_lim relative to the initial position, using self.space_lim define the 0 to be initial position</span>
        <span class="c1"># self.space_lim is in general shape (3,2) while the initials is in shape (3,)</span>
        <span class="c1"># make sure the - operator is broadcasted correctly</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">initials</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="c1"># change the shape to (3,)</span>
            <span class="n">initials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">initials</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initials</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
        <span class="c1"># subtract each element of the first dimension of self.space_lim by the first element of initials</span>

        <span class="c1"># convert the diffusion_coefficients</span>
        <span class="c1"># diffusion_parameters = self._convert_diffcoef_um2s_um2xms(diffusion_parameters)</span>
        <span class="c1"># initialize the fbm class</span>
        <span class="n">fbm</span> <span class="o">=</span> <span class="n">FBM_BP</span><span class="p">(</span>
            <span class="n">n</span><span class="o">=</span><span class="n">track_length</span><span class="p">,</span>
            <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
            <span class="n">hurst_parameters</span><span class="o">=</span><span class="n">hurst_parameters</span><span class="p">,</span>
            <span class="n">diffusion_parameters</span><span class="o">=</span><span class="n">diffusion_parameters</span><span class="p">,</span>
            <span class="n">diffusion_parameter_transition_matrix</span><span class="o">=</span><span class="n">diffusion_transition_matrix</span><span class="p">,</span>
            <span class="n">hurst_parameter_transition_matrix</span><span class="o">=</span><span class="n">hurst_transition_matrix</span><span class="p">,</span>
            <span class="n">state_probability_diffusion</span><span class="o">=</span><span class="n">diffusion_state_probability</span><span class="p">,</span>
            <span class="n">state_probability_hurst</span><span class="o">=</span><span class="n">hurst_state_probability</span><span class="p">,</span>
            <span class="n">cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>
            <span class="n">initial_position</span><span class="o">=</span><span class="n">initials</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="n">fbm</span><span class="o">.</span><span class="n">fbm</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># make the times starting from the starting time</span>
        <span class="n">track_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="n">start_time</span><span class="p">,</span>
            <span class="n">track_length</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">track_xyz</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="c1"># create the dict</span>
        <span class="n">track_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="n">track_xyz</span><span class="p">,</span>
            <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">track_times</span><span class="p">,</span>
            <span class="s2">&quot;diffusion_coefficient&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_diff_a_n</span><span class="p">,</span>
            <span class="s2">&quot;hurst&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_hurst_n</span><span class="p">,</span>
            <span class="s2">&quot;initial&quot;</span><span class="p">:</span> <span class="n">initials</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># construct the dict</span>
        <span class="k">return</span> <span class="n">track_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">track_generation_constant</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">track_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">initials</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">start_time</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a constant track (no movement).</span>

<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        track_length : int</span>
<span class="sd">            mean track length, in this case the track length is constant with this mean</span>
<span class="sd">        initials : array-like</span>
<span class="sd">            [[x,y,z]] coordinates of the initial positions of the track</span>
<span class="sd">        starting_time : int</span>
<span class="sd">            time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        dict-like with format: {&quot;xy&quot;:xyz,&quot;times&quot;:times,&quot;diffusion_coefficient&quot;:diffusion_coefficient,&quot;hurst&quot;:hurst_exponent,&quot;initial&quot;:initial}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># make the times starting from the starting time</span>
        <span class="n">track_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="n">start_time</span><span class="p">,</span>
            <span class="n">track_length</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># make the track x,y,z from the initial positions</span>
        <span class="n">track_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">initials</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">track_times</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1"># construct the dict</span>
        <span class="n">track_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="n">track_xyz</span><span class="p">,</span>
            <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">track_times</span><span class="p">,</span>
            <span class="s2">&quot;diffusion_coefficient&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;hurst&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;initial&quot;</span><span class="p">:</span> <span class="n">initials</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">track_data</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_diffcoef_um2s_um2xms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diffusion_coefficient</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_diffcoef_um2s_um2xms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">diffusion_coefficient</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span> <span class="o">...</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_diffcoef_um2s_um2xms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diffusion_coefficient</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span> <span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_diffcoef_um2s_um2xms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">diffusion_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;converts um^2/s diffusion_coefficient into um^2/ x ms</span>
<span class="sd">        x = amount of ms</span>
<span class="sd">        ms = milliseconds</span>

<span class="sd">        x ms = self.oversample_motion_time (in ms, int)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diffusion_coefficient</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span><span class="p">)</span>
            <span class="p">)</span> <span class="o">*</span> <span class="n">diffusion_coefficient</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">diffusion_coefficient</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span><span class="p">))</span> <span class="o">*</span> <span class="n">i</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">diffusion_coefficient</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">diffusion_coefficient</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_time_to_frame</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exposure_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval_time</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        time : int</span>
<span class="sd">            time in ms</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        int: frame number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span>
            <span class="p">(</span><span class="n">time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">exposure_time</span> <span class="o">+</span> <span class="n">interval_time</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_frame_to_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exposure_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval_time</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        frame : int</span>
<span class="sd">            frame number</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        int: time in ms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="n">frame</span> <span class="o">*</span> <span class="p">(</span><span class="n">exposure_time</span> <span class="o">+</span> <span class="n">interval_time</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SMS_BP.simulate_foci.Track_generator.track_generation_constant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">track_generation_constant</span><span class="p">(</span><span class="n">track_length</span><span class="p">,</span> <span class="n">initials</span><span class="p">,</span> <span class="n">start_time</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a constant track (no movement).</p>
<h6 id="SMS_BP.simulate_foci.Track_generator.track_generation_constant--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant--parameters" title="Permanent link">#</a></h6>
<p>track_length : int
    mean track length, in this case the track length is constant with this mean
initials : array-like
    [[x,y,z]] coordinates of the initial positions of the track
starting_time : int
    time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</p>
<h6 id="SMS_BP.simulate_foci.Track_generator.track_generation_constant--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.Track_generator.track_generation_constant--returns" title="Permanent link">#</a></h6>
<p>dict-like with format: {"xy":xyz,"times":times,"diffusion_coefficient":diffusion_coefficient,"hurst":hurst_exponent,"initial":initial}</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">track_generation_constant</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">track_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">initials</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">start_time</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a constant track (no movement).</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    track_length : int</span>
<span class="sd">        mean track length, in this case the track length is constant with this mean</span>
<span class="sd">    initials : array-like</span>
<span class="sd">        [[x,y,z]] coordinates of the initial positions of the track</span>
<span class="sd">    starting_time : int</span>
<span class="sd">        time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    dict-like with format: {&quot;xy&quot;:xyz,&quot;times&quot;:times,&quot;diffusion_coefficient&quot;:diffusion_coefficient,&quot;hurst&quot;:hurst_exponent,&quot;initial&quot;:initial}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make the times starting from the starting time</span>
    <span class="n">track_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
        <span class="n">start_time</span><span class="p">,</span>
        <span class="n">track_length</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># make the track x,y,z from the initial positions</span>
    <span class="n">track_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">initials</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">track_times</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># construct the dict</span>
    <span class="n">track_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="n">track_xyz</span><span class="p">,</span>
        <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">track_times</span><span class="p">,</span>
        <span class="s2">&quot;diffusion_coefficient&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;hurst&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;initial&quot;</span><span class="p">:</span> <span class="n">initials</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">track_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SMS_BP.simulate_foci.Track_generator.track_generation_no_transition" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">track_generation_no_transition</span><span class="p">(</span><span class="n">diffusion_coefficient</span><span class="p">,</span> <span class="n">hurst_exponent</span><span class="p">,</span> <span class="n">track_length</span><span class="p">,</span> <span class="n">initials</span><span class="p">,</span> <span class="n">start_time</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.Track_generator.track_generation_no_transition" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Simulates the track generation with no transition between the diffusion coefficients and the hurst exponents
namely, this means each track has a unique diffusion coefficient and hurst exponent
This simulation is confined to the cell space and the axial range of the cell</p>
<h6 id="SMS_BP.simulate_foci.Track_generator.track_generation_no_transition--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.Track_generator.track_generation_no_transition--parameters" title="Permanent link">#</a></h6>
<p>diffusion_coefficient : float
    diffusion coefficient for the track
hurst_exponent : float
    hurst exponent for the track
track_length : int
    track_length for the track
initials : array-like
    [[x,y,z]] coordinates of the initial positions of the track
start_time : int
    time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)
Returns:</p>
<hr />
<p>dict-like with format: {"xy":xyz,"times":times,"diffusion_coefficient":diffusion_coefficient,"hurst":hurst_exponent,"initial":initial}</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">track_generation_no_transition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">diffusion_coefficient</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>  <span class="c1"># um^2/s</span>
    <span class="n">hurst_exponent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">track_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">initials</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates the track generation with no transition between the diffusion coefficients and the hurst exponents</span>
<span class="sd">    namely, this means each track has a unique diffusion coefficient and hurst exponent</span>
<span class="sd">    This simulation is confined to the cell space and the axial range of the cell</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    diffusion_coefficient : float</span>
<span class="sd">        diffusion coefficient for the track</span>
<span class="sd">    hurst_exponent : float</span>
<span class="sd">        hurst exponent for the track</span>
<span class="sd">    track_length : int</span>
<span class="sd">        track_length for the track</span>
<span class="sd">    initials : array-like</span>
<span class="sd">        [[x,y,z]] coordinates of the initial positions of the track</span>
<span class="sd">    start_time : int</span>
<span class="sd">        time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    dict-like with format: {&quot;xy&quot;:xyz,&quot;times&quot;:times,&quot;diffusion_coefficient&quot;:diffusion_coefficient,&quot;hurst&quot;:hurst_exponent,&quot;initial&quot;:initial}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># initialize the fbm class</span>
    <span class="c1"># make self.space_lim relative to the initial position, using self.space_lim define the 0 to be initial position</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">initials</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="c1"># change the shape to (3,)</span>
        <span class="n">initials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">initials</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initials</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
    <span class="c1"># convert the diffusion_coefficients</span>
    <span class="c1"># diffusion_coefficient = self._convert_diffcoef_um2s_um2xms(</span>
    <span class="c1">#     diffusion_coefficient</span>
    <span class="c1"># )</span>
    <span class="n">fbm</span> <span class="o">=</span> <span class="n">FBM_BP</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="n">track_length</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
        <span class="n">hurst_parameters</span><span class="o">=</span><span class="p">[</span><span class="n">hurst_exponent</span><span class="p">],</span>
        <span class="n">diffusion_parameters</span><span class="o">=</span><span class="p">[</span><span class="n">diffusion_coefficient</span><span class="p">],</span>
        <span class="n">diffusion_parameter_transition_matrix</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">hurst_parameter_transition_matrix</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">state_probability_diffusion</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">state_probability_hurst</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>
        <span class="n">initial_position</span><span class="o">=</span><span class="n">initials</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">fbm</span><span class="o">.</span><span class="n">fbm</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># make the times starting from the starting time</span>
    <span class="n">track_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
        <span class="n">start_time</span><span class="p">,</span>
        <span class="p">(</span><span class="n">track_length</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">track_xyz</span> <span class="o">=</span> <span class="n">xyz</span>
    <span class="c1"># create the dict</span>
    <span class="n">track_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="n">track_xyz</span><span class="p">,</span>
        <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">track_times</span><span class="p">,</span>
        <span class="s2">&quot;diffusion_coefficient&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_diff_a_n</span><span class="p">,</span>
        <span class="s2">&quot;hurst&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_hurst_n</span><span class="p">,</span>
        <span class="s2">&quot;initial&quot;</span><span class="p">:</span> <span class="n">initials</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># construct the dict</span>
    <span class="k">return</span> <span class="n">track_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SMS_BP.simulate_foci.Track_generator.track_generation_with_transition" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">track_generation_with_transition</span><span class="p">(</span><span class="n">diffusion_transition_matrix</span><span class="p">,</span> <span class="n">hurst_transition_matrix</span><span class="p">,</span> <span class="n">diffusion_parameters</span><span class="p">,</span> <span class="n">hurst_parameters</span><span class="p">,</span> <span class="n">diffusion_state_probability</span><span class="p">,</span> <span class="n">hurst_state_probability</span><span class="p">,</span> <span class="n">track_length</span><span class="p">,</span> <span class="n">initials</span><span class="p">,</span> <span class="n">start_time</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Genereates the track data with transition between the diffusion coefficients and the hurst exponents</p>
<h6 id="SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--parameters" title="Permanent link">#</a></h6>
<p>diffusion_transition_matrix : array-like
    transition matrix for the diffusion coefficients
hurst_transition_matrix : array-like
    transition matrix for the hurst exponents
diffusion_parameters : array-like
    diffusion coefficients for the tracks
hurst_parameters : array-like
    hurst exponents for the tracks
diffusion_state_probability : array-like
    probabilities for the diffusion coefficients
hurst_state_probability : array-like
    probabilities for the hurst exponents
track_length : int
    track_length for the track
initials : array-like
    [[x,y,z]] coordinates of the initial positions of the track
start_time : int
    time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</p>
<h6 id="SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.Track_generator.track_generation_with_transition--returns" title="Permanent link">#</a></h6>
<p>dict-like with format: {"xy":xyz,"times":times,"diffusion_coefficient":diffusion_coefficient,"hurst":hurst_exponent,"initial":initial}</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">track_generation_with_transition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">diffusion_transition_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">hurst_transition_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">diffusion_parameters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>  <span class="c1"># um^2/s</span>
    <span class="n">hurst_parameters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">diffusion_state_probability</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">hurst_state_probability</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">track_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">initials</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Genereates the track data with transition between the diffusion coefficients and the hurst exponents</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    diffusion_transition_matrix : array-like</span>
<span class="sd">        transition matrix for the diffusion coefficients</span>
<span class="sd">    hurst_transition_matrix : array-like</span>
<span class="sd">        transition matrix for the hurst exponents</span>
<span class="sd">    diffusion_parameters : array-like</span>
<span class="sd">        diffusion coefficients for the tracks</span>
<span class="sd">    hurst_parameters : array-like</span>
<span class="sd">        hurst exponents for the tracks</span>
<span class="sd">    diffusion_state_probability : array-like</span>
<span class="sd">        probabilities for the diffusion coefficients</span>
<span class="sd">    hurst_state_probability : array-like</span>
<span class="sd">        probabilities for the hurst exponents</span>
<span class="sd">    track_length : int</span>
<span class="sd">        track_length for the track</span>
<span class="sd">    initials : array-like</span>
<span class="sd">        [[x,y,z]] coordinates of the initial positions of the track</span>
<span class="sd">    start_time : int</span>
<span class="sd">        time at which the track start (this is not the frame, and needs to be converted to the frame using the exposure time and interval time and the oversample motion time)</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    dict-like with format: {&quot;xy&quot;:xyz,&quot;times&quot;:times,&quot;diffusion_coefficient&quot;:diffusion_coefficient,&quot;hurst&quot;:hurst_exponent,&quot;initial&quot;:initial}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make self.space_lim relative to the initial position, using self.space_lim define the 0 to be initial position</span>
    <span class="c1"># self.space_lim is in general shape (3,2) while the initials is in shape (3,)</span>
    <span class="c1"># make sure the - operator is broadcasted correctly</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">initials</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="c1"># change the shape to (3,)</span>
        <span class="n">initials</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">initials</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initials</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
    <span class="c1"># subtract each element of the first dimension of self.space_lim by the first element of initials</span>

    <span class="c1"># convert the diffusion_coefficients</span>
    <span class="c1"># diffusion_parameters = self._convert_diffcoef_um2s_um2xms(diffusion_parameters)</span>
    <span class="c1"># initialize the fbm class</span>
    <span class="n">fbm</span> <span class="o">=</span> <span class="n">FBM_BP</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="n">track_length</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">oversample_motion_time</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
        <span class="n">hurst_parameters</span><span class="o">=</span><span class="n">hurst_parameters</span><span class="p">,</span>
        <span class="n">diffusion_parameters</span><span class="o">=</span><span class="n">diffusion_parameters</span><span class="p">,</span>
        <span class="n">diffusion_parameter_transition_matrix</span><span class="o">=</span><span class="n">diffusion_transition_matrix</span><span class="p">,</span>
        <span class="n">hurst_parameter_transition_matrix</span><span class="o">=</span><span class="n">hurst_transition_matrix</span><span class="p">,</span>
        <span class="n">state_probability_diffusion</span><span class="o">=</span><span class="n">diffusion_state_probability</span><span class="p">,</span>
        <span class="n">state_probability_hurst</span><span class="o">=</span><span class="n">hurst_state_probability</span><span class="p">,</span>
        <span class="n">cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>
        <span class="n">initial_position</span><span class="o">=</span><span class="n">initials</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">fbm</span><span class="o">.</span><span class="n">fbm</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># make the times starting from the starting time</span>
    <span class="n">track_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
        <span class="n">start_time</span><span class="p">,</span>
        <span class="n">track_length</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">track_xyz</span> <span class="o">=</span> <span class="n">xyz</span>
    <span class="c1"># create the dict</span>
    <span class="n">track_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="n">track_xyz</span><span class="p">,</span>
        <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">track_times</span><span class="p">,</span>
        <span class="s2">&quot;diffusion_coefficient&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_diff_a_n</span><span class="p">,</span>
        <span class="s2">&quot;hurst&quot;</span><span class="p">:</span> <span class="n">fbm</span><span class="o">.</span><span class="n">_hurst_n</span><span class="p">,</span>
        <span class="s2">&quot;initial&quot;</span><span class="p">:</span> <span class="n">initials</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># construct the dict</span>
    <span class="k">return</span> <span class="n">track_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.axial_intensity_factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">axial_intensity_factor</span><span class="p">(</span><span class="n">abs_axial_pos</span><span class="p">,</span> <span class="n">detection_range</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.axial_intensity_factor" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Docstring
Calculate the factor for the axial intensity of the PSF given the absolute axial position from the 0 position of
the focal plane. This is the factor that is multiplied by the intensity of the PSF</p>
<p>For now this is a negative exponential decay i.e:
    I = I_0<em>e^(-|z-z_0|)
This function returns the factor e^(-|z-z_0|</em><em>2 / (2</em>2.2**2)) only.</p>
<h5 id="SMS_BP.simulate_foci.axial_intensity_factor--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.axial_intensity_factor--parameters" title="Permanent link">#</a></h5>
<p>abs_axial_pos : float|np.ndarray
    absolute axial position from the 0 position of the focal plane
detection_range : float
    detection range of the function. This is the standard deviation of the gaussian function describing the axial intensity decay assuming a gaussian function.
kwargs : dict</p>
<h5 id="SMS_BP.simulate_foci.axial_intensity_factor--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.axial_intensity_factor--returns" title="Permanent link">#</a></h5>
<p>float|np.ndarray
    factor for the axial intensity of the PSF</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">axial_intensity_factor</span><span class="p">(</span>
    <span class="n">abs_axial_pos</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">detection_range</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Docstring</span>
<span class="sd">    Calculate the factor for the axial intensity of the PSF given the absolute axial position from the 0 position of</span>
<span class="sd">    the focal plane. This is the factor that is multiplied by the intensity of the PSF</span>

<span class="sd">    For now this is a negative exponential decay i.e:</span>
<span class="sd">        I = I_0*e^(-|z-z_0|)</span>
<span class="sd">    This function returns the factor e^(-|z-z_0|**2 / (2*2.2**2)) only.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    abs_axial_pos : float|np.ndarray</span>
<span class="sd">        absolute axial position from the 0 position of the focal plane</span>
<span class="sd">    detection_range : float</span>
<span class="sd">        detection range of the function. This is the standard deviation of the gaussian function describing the axial intensity decay assuming a gaussian function.</span>
<span class="sd">    kwargs : dict</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    float|np.ndarray</span>
<span class="sd">        factor for the axial intensity of the PSF</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">func_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;func&quot;</span><span class="p">,</span> <span class="s2">&quot;ones&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func_type</span> <span class="o">==</span> <span class="s2">&quot;ones&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abs_axial_pos</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">func_type</span> <span class="o">==</span> <span class="s2">&quot;exponential&quot;</span><span class="p">:</span>
        <span class="c1"># for now this uses a negative exponential decay</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">abs_axial_pos</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">detection_range</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.generate_map_from_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_map_from_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">point_intensity</span><span class="p">,</span> <span class="nb">map</span><span class="p">,</span> <span class="n">movie</span><span class="p">,</span> <span class="n">base_noise</span><span class="p">,</span> <span class="n">psf_sigma</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.generate_map_from_points" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Generates a 2D spatial map from a set of points and their intensities.</p>
<h5 id="SMS_BP.simulate_foci.generate_map_from_points--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_map_from_points--parameters" title="Permanent link">#</a></h5>
<p>points : np.ndarray
    Array of points of shape (total_points, 2).
point_intensity : float | np.ndarray
    Intensity of the points.
map : np.ndarray
    Pre-defined space map to update. If None, a new map is generated.
movie : bool
    If True, noise is added to the whole image at once; otherwise, noise is added per point.
base_noise : float
    Base noise level to add to the spatial map.
psf_sigma : float
    Sigma of the PSF (in pixel units).</p>
<h5 id="SMS_BP.simulate_foci.generate_map_from_points--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_map_from_points--returns" title="Permanent link">#</a></h5>
<p>tuple[np.ndarray, np.ndarray]
    The updated spatial map and the points.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_map_from_points</span><span class="p">(</span>
    <span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">point_intensity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="nb">map</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">movie</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">base_noise</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">psf_sigma</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a 2D spatial map from a set of points and their intensities.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    points : np.ndarray</span>
<span class="sd">        Array of points of shape (total_points, 2).</span>
<span class="sd">    point_intensity : float | np.ndarray</span>
<span class="sd">        Intensity of the points.</span>
<span class="sd">    map : np.ndarray</span>
<span class="sd">        Pre-defined space map to update. If None, a new map is generated.</span>
<span class="sd">    movie : bool</span>
<span class="sd">        If True, noise is added to the whole image at once; otherwise, noise is added per point.</span>
<span class="sd">    base_noise : float</span>
<span class="sd">        Base noise level to add to the spatial map.</span>
<span class="sd">    psf_sigma : float</span>
<span class="sd">        Sigma of the PSF (in pixel units).</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    tuple[np.ndarray, np.ndarray]</span>
<span class="sd">        The updated spatial map and the points.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">space_map</span> <span class="o">=</span> <span class="nb">map</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="nb">map</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="nb">map</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">point_intensity</span><span class="p">):</span>
        <span class="n">point_intensity</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">point_intensity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
            <span class="n">space_map</span> <span class="o">+=</span> <span class="n">get_gaussian</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">psf_sigma</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
            <span class="n">gauss_probability</span> <span class="o">=</span> <span class="n">get_gaussian</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">psf_sigma</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
            <span class="c1"># normalize</span>
            <span class="n">gauss_probability</span> <span class="o">=</span> <span class="n">gauss_probability</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gauss_probability</span><span class="p">)</span>

            <span class="c1"># generate poisson process over this space using the gaussian probability as means</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">movie</span><span class="p">:</span>
                <span class="n">space_map</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span>
                    <span class="n">gauss_probability</span> <span class="o">*</span> <span class="n">point_intensity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">base_noise</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">space_map</span> <span class="o">+=</span> <span class="n">gauss_probability</span> <span class="o">*</span> <span class="n">point_intensity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">movie</span><span class="p">:</span>
            <span class="n">intensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">space_map</span> <span class="o">+</span> <span class="n">base_noise</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
            <span class="n">space_map</span> <span class="o">=</span> <span class="n">intensity</span>
    <span class="k">return</span> <span class="n">space_map</span><span class="p">,</span> <span class="n">points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.generate_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_points</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">total_points</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">bias_subspace_x</span><span class="p">,</span> <span class="n">space_prob</span><span class="p">,</span> <span class="n">density_dif</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.generate_points" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Generates random (x, y) points using the accept/reject method based on a given distribution.</p>
<h5 id="SMS_BP.simulate_foci.generate_points--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_points--parameters" title="Permanent link">#</a></h5>
<p>pdf : callable
    Probability density function to sample from.
total_points : int
    Number of points to generate.
min_x : float
    Minimum x value for sampling.
max_x : float
    Maximum x value for sampling.
center : np.ndarray
    Coordinates of the center of the top-hat distribution.
radius : float
    Radius of the top-hat region.
bias_subspace_x : float
    Probability at the top of the top-hat.
space_prob : float
    Probability outside the top-hat region.
density_dif : float
    Scaling factor for density differences.</p>
<h5 id="SMS_BP.simulate_foci.generate_points--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_points--returns" title="Permanent link">#</a></h5>
<p>np.ndarray
    Array of generated points.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_points</span><span class="p">(</span>
    <span class="n">pdf</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span>
    <span class="n">total_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">min_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">max_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">bias_subspace_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">space_prob</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">density_dif</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates random (x, y) points using the accept/reject method based on a given distribution.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    pdf : callable</span>
<span class="sd">        Probability density function to sample from.</span>
<span class="sd">    total_points : int</span>
<span class="sd">        Number of points to generate.</span>
<span class="sd">    min_x : float</span>
<span class="sd">        Minimum x value for sampling.</span>
<span class="sd">    max_x : float</span>
<span class="sd">        Maximum x value for sampling.</span>
<span class="sd">    center : np.ndarray</span>
<span class="sd">        Coordinates of the center of the top-hat distribution.</span>
<span class="sd">    radius : float</span>
<span class="sd">        Radius of the top-hat region.</span>
<span class="sd">    bias_subspace_x : float</span>
<span class="sd">        Probability at the top of the top-hat.</span>
<span class="sd">    space_prob : float</span>
<span class="sd">        Probability outside the top-hat region.</span>
<span class="sd">    density_dif : float</span>
<span class="sd">        Scaling factor for density differences.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Array of generated points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xy_coords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">total_points</span><span class="p">:</span>
        <span class="c1"># generate candidate variable</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_x</span><span class="p">],</span> <span class="p">[</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">])</span>
        <span class="c1"># generate varibale to condition var1</span>
        <span class="n">var2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># apply condition</span>
        <span class="n">pdf_val</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">bias_subspace_x</span><span class="p">,</span> <span class="n">space_prob</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">var2</span> <span class="o">&lt;</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">density_dif</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_x</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf_val</span><span class="p">:</span>
            <span class="n">xy_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.generate_points_from_cls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_points_from_cls</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">total_points</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">density_dif</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.generate_points_from_cls" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Generates random (x, y, z) points using the accept/reject method based on a given distribution.</p>
<h5 id="SMS_BP.simulate_foci.generate_points_from_cls--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_points_from_cls--parameters" title="Permanent link">#</a></h5>
<p>pdf : callable
    Probability density function to sample from.
total_points : int
    Number of points to generate.
bound : list with the following
    min_x : float
        Minimum x value for sampling.
    max_x : float
        Maximum x value for sampling.
    min_y : float
        Minimum y value for sampling.
    max_y : float
        Maximum y value for sampling.
    min_z : float
        Minimum z value for sampling.
    max_z : float
        Maximum z value for sampling.
volume : float,
    volume of region sampling
density_dif : float
    Scaling factor for density differences.</p>
<h5 id="SMS_BP.simulate_foci.generate_points_from_cls--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_points_from_cls--returns" title="Permanent link">#</a></h5>
<p>np.ndarray
    Array of generated (x, y, z) points.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_points_from_cls</span><span class="p">(</span>
    <span class="n">pdf</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">total_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">volume</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">density_dif</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates random (x, y, z) points using the accept/reject method based on a given distribution.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    pdf : callable</span>
<span class="sd">        Probability density function to sample from.</span>
<span class="sd">    total_points : int</span>
<span class="sd">        Number of points to generate.</span>
<span class="sd">    bound : list with the following</span>
<span class="sd">        min_x : float</span>
<span class="sd">            Minimum x value for sampling.</span>
<span class="sd">        max_x : float</span>
<span class="sd">            Maximum x value for sampling.</span>
<span class="sd">        min_y : float</span>
<span class="sd">            Minimum y value for sampling.</span>
<span class="sd">        max_y : float</span>
<span class="sd">            Maximum y value for sampling.</span>
<span class="sd">        min_z : float</span>
<span class="sd">            Minimum z value for sampling.</span>
<span class="sd">        max_z : float</span>
<span class="sd">            Maximum z value for sampling.</span>
<span class="sd">    volume : float,</span>
<span class="sd">        volume of region sampling</span>
<span class="sd">    density_dif : float</span>
<span class="sd">        Scaling factor for density differences.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Array of generated (x, y, z) points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">,</span> <span class="n">min_z</span><span class="p">,</span> <span class="n">max_z</span> <span class="o">=</span> <span class="n">bounds</span>
    <span class="n">xyz_coords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">xyz_coords</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">total_points</span><span class="p">:</span>
        <span class="c1"># generate candidate variable</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">,</span> <span class="n">min_z</span><span class="p">],</span> <span class="p">[</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">,</span> <span class="n">max_z</span><span class="p">])</span>
        <span class="c1"># generate varibale to condition var1</span>
        <span class="n">var2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># apply condition</span>
        <span class="n">pdf_val</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">var2</span> <span class="o">&lt;</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">density_dif</span><span class="p">)</span> <span class="o">*</span> <span class="n">volume</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf_val</span><span class="p">:</span>
            <span class="n">xyz_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xyz_coords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.generate_radial_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_radial_points</span><span class="p">(</span><span class="n">total_points</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.generate_radial_points" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Generates uniformly distributed points in a circle of a given radius.</p>
<h5 id="SMS_BP.simulate_foci.generate_radial_points--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_radial_points--parameters" title="Permanent link">#</a></h5>
<p>total_points : int
    Number of points to generate.
center : np.ndarray
    Coordinates of the center of the circle.
radius : float
    Radius of the circle.</p>
<h5 id="SMS_BP.simulate_foci.generate_radial_points--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_radial_points--returns" title="Permanent link">#</a></h5>
<p>np.ndarray
    Array of generated (x, y) coordinates.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_radial_points</span><span class="p">(</span>
    <span class="n">total_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates uniformly distributed points in a circle of a given radius.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    total_points : int</span>
<span class="sd">        Number of points to generate.</span>
<span class="sd">    center : np.ndarray</span>
<span class="sd">        Coordinates of the center of the circle.</span>
<span class="sd">    radius : float</span>
<span class="sd">        Radius of the circle.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Array of generated (x, y) coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">total_points</span><span class="p">)</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">total_points</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.generate_sphere_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_sphere_points</span><span class="p">(</span><span class="n">total_points</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.generate_sphere_points" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Generates uniformly distributed points in a sphere of a given radius.</p>
<h5 id="SMS_BP.simulate_foci.generate_sphere_points--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_sphere_points--parameters" title="Permanent link">#</a></h5>
<p>total_points : int
    Number of points to generate.
center : np.ndarray
    Coordinates of the center of the sphere.
radius : float
    Radius of the sphere.</p>
<h5 id="SMS_BP.simulate_foci.generate_sphere_points--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.generate_sphere_points--returns" title="Permanent link">#</a></h5>
<p>np.ndarray
    Array of generated (x, y, z) coordinates.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_sphere_points</span><span class="p">(</span>
    <span class="n">total_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates uniformly distributed points in a sphere of a given radius.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    total_points : int</span>
<span class="sd">        Number of points to generate.</span>
<span class="sd">    center : np.ndarray</span>
<span class="sd">        Coordinates of the center of the sphere.</span>
<span class="sd">    radius : float</span>
<span class="sd">        Radius of the sphere.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Array of generated (x, y, z) coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check to see if the center is an array of size 3</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># make it an array of size 3 with the last element being 0</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">total_points</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">total_points</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cbrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">total_points</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.get_gaussian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))])</span></code>

<a href="#SMS_BP.simulate_foci.get_gaussian" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Generates a 2D Gaussian distribution over a given domain.</p>
<h5 id="SMS_BP.simulate_foci.get_gaussian--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.get_gaussian--parameters" title="Permanent link">#</a></h5>
<p>mu : np.ndarray
    Center position of the Gaussian (x, y).
sigma : float | np.ndarray
    Standard deviation(s) of the Gaussian.
domain : list[list[int]], optional
    Domain over which to compute the Gaussian (default is 0-9 for x and y).</p>
<h5 id="SMS_BP.simulate_foci.get_gaussian--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.get_gaussian--returns" title="Permanent link">#</a></h5>
<p>np.ndarray
    2D array representing the Gaussian distribution over the domain.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_gaussian</span><span class="p">(</span>
    <span class="n">mu</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">domain</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a 2D Gaussian distribution over a given domain.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    mu : np.ndarray</span>
<span class="sd">        Center position of the Gaussian (x, y).</span>
<span class="sd">    sigma : float | np.ndarray</span>
<span class="sd">        Standard deviation(s) of the Gaussian.</span>
<span class="sd">    domain : list[list[int]], optional</span>
<span class="sd">        Domain over which to compute the Gaussian (default is 0-9 for x and y).</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        2D array representing the Gaussian distribution over the domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># generate a multivariate normal distribution with the given mu and sigma over the domain using scipy stats</span>
    <span class="c1"># generate the grid</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1"># generate the multivariate normal distribution</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="c1"># generate the probability distribution</span>
    <span class="n">gauss</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)))</span>
    <span class="c1"># reshape the distribution on the grid</span>
    <span class="k">return</span> <span class="n">gauss</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.get_lengths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_lengths</span><span class="p">(</span><span class="n">track_distribution</span><span class="p">,</span> <span class="n">track_length_mean</span><span class="p">,</span> <span class="n">total_tracks</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.get_lengths" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Returns track lengths based on the specified distribution.</p>
<h5 id="SMS_BP.simulate_foci.get_lengths--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.get_lengths--parameters" title="Permanent link">#</a></h5>
<p>track_distribution : str
    The distribution of track lengths. Options are "exponential", "uniform", and "constant".
track_length_mean : int
    The mean length of the tracks.
total_tracks : int
    The total number of tracks to generate.</p>
<h5 id="SMS_BP.simulate_foci.get_lengths--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.get_lengths--returns" title="Permanent link">#</a></h5>
<p>np.ndarray
    An array of track lengths (shape: (total_tracks,)).</p>
<h5 id="SMS_BP.simulate_foci.get_lengths--raises">Raises:<a class="headerlink" href="#SMS_BP.simulate_foci.get_lengths--raises" title="Permanent link">#</a></h5>
<p>ValueError
    If the distribution type is not recognized.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_lengths</span><span class="p">(</span>
    <span class="n">track_distribution</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">track_length_mean</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">total_tracks</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns track lengths based on the specified distribution.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    track_distribution : str</span>
<span class="sd">        The distribution of track lengths. Options are &quot;exponential&quot;, &quot;uniform&quot;, and &quot;constant&quot;.</span>
<span class="sd">    track_length_mean : int</span>
<span class="sd">        The mean length of the tracks.</span>
<span class="sd">    total_tracks : int</span>
<span class="sd">        The total number of tracks to generate.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        An array of track lengths (shape: (total_tracks,)).</span>

<span class="sd">    Raises:</span>
<span class="sd">    -------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the distribution type is not recognized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">track_distribution</span> <span class="o">==</span> <span class="s2">&quot;exponential&quot;</span><span class="p">:</span>
        <span class="c1"># make sure each of the lengths is an integer and is greater than or equal to 1</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">track_length_mean</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">total_tracks</span><span class="p">)),</span>
            <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">track_distribution</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
        <span class="c1"># make sure each of the lengths is an integer</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
                    <span class="n">low</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">track_length_mean</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">total_tracks</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">track_distribution</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">total_tracks</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">track_length_mean</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Distribution not recognized&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.radius_spherical_cap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">radius_spherical_cap</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">z_slice</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.radius_spherical_cap" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates the radius of a spherical cap at a given z-slice.</p>
<h5 id="SMS_BP.simulate_foci.radius_spherical_cap--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.radius_spherical_cap--parameters" title="Permanent link">#</a></h5>
<p>R : float
    Radius of the sphere.
center : np.ndarray
    [x, y, z] coordinates of the center of the sphere.
z_slice : float
    Z-coordinate of the slice relative to the sphere's center.</p>
<h5 id="SMS_BP.simulate_foci.radius_spherical_cap--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.radius_spherical_cap--returns" title="Permanent link">#</a></h5>
<p>float
    Radius of the spherical cap at the given z-slice.</p>
<h5 id="SMS_BP.simulate_foci.radius_spherical_cap--raises">Raises:<a class="headerlink" href="#SMS_BP.simulate_foci.radius_spherical_cap--raises" title="Permanent link">#</a></h5>
<p>ValueError
    If the z-slice is outside the sphere.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">radius_spherical_cap</span><span class="p">(</span><span class="n">R</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">z_slice</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the radius of a spherical cap at a given z-slice.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    R : float</span>
<span class="sd">        Radius of the sphere.</span>
<span class="sd">    center : np.ndarray</span>
<span class="sd">        [x, y, z] coordinates of the center of the sphere.</span>
<span class="sd">    z_slice : float</span>
<span class="sd">        Z-coordinate of the slice relative to the sphere&#39;s center.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    float</span>
<span class="sd">        Radius of the spherical cap at the given z-slice.</span>

<span class="sd">    Raises:</span>
<span class="sd">    -------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the z-slice is outside the sphere.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if z_slice is within the sphere</span>
    <span class="k">if</span> <span class="n">z_slice</span> <span class="o">&gt;</span> <span class="n">R</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;z_slice is outside the sphere&quot;</span><span class="p">)</span>
    <span class="c1"># check if z_slice is at the edge of the sphere</span>
    <span class="k">if</span> <span class="n">z_slice</span> <span class="o">==</span> <span class="n">R</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="c1"># check if z_slice is at the center of the sphere</span>
    <span class="k">if</span> <span class="n">z_slice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">R</span>
    <span class="c1"># calculate the radius of the spherical cap</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">z_slice</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="SMS_BP.simulate_foci.tophat_function_2d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tophat_function_2d</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">bias_subspace</span><span class="p">,</span> <span class="n">space_prob</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#SMS_BP.simulate_foci.tophat_function_2d" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Defines a circular top-hat probability distribution in 2D.</p>
<h5 id="SMS_BP.simulate_foci.tophat_function_2d--parameters">Parameters:<a class="headerlink" href="#SMS_BP.simulate_foci.tophat_function_2d--parameters" title="Permanent link">#</a></h5>
<p>var : np.ndarray
    [x, y] coordinates for sampling the distribution.
center : np.ndarray
    [c1, c2] coordinates representing the center of the top-hat region.
radius : float
    Radius of the circular top-hat.
bias_subspace : float
    Probability at the center of the top-hat.
space_prob : float
    Probability outside the top-hat region.</p>
<h5 id="SMS_BP.simulate_foci.tophat_function_2d--returns">Returns:<a class="headerlink" href="#SMS_BP.simulate_foci.tophat_function_2d--returns" title="Permanent link">#</a></h5>
<p>float
    The probability value at the given coordinates.</p>


            <details class="quote">
              <summary>Source code in <code>SMS_BP/simulate_foci.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tophat_function_2d</span><span class="p">(</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">bias_subspace</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">space_prob</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines a circular top-hat probability distribution in 2D.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    var : np.ndarray</span>
<span class="sd">        [x, y] coordinates for sampling the distribution.</span>
<span class="sd">    center : np.ndarray</span>
<span class="sd">        [c1, c2] coordinates representing the center of the top-hat region.</span>
<span class="sd">    radius : float</span>
<span class="sd">        Radius of the circular top-hat.</span>
<span class="sd">    bias_subspace : float</span>
<span class="sd">        Probability at the center of the top-hat.</span>
<span class="sd">    space_prob : float</span>
<span class="sd">        Probability outside the top-hat region.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    float</span>
<span class="sd">        The probability value at the given coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bias_subspace</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">space_prob</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../simulate_cell_reference/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Simulate Cell">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Simulate Cell
              </div>
            </div>
          </a>
        
        
          
          <a href="../license/" class="md-footer__link md-footer__link--next" aria-label="Next: License">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                License
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer", "search.suggest"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>